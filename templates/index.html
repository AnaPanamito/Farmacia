<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Sistema de Farmacias{% endblock %}</title>
</head>
<body>
    <!-- Menú de navegación -->
    <nav>
        <ul>
            <li><a href="{% url 'index' %}">Inicio</a></li>
            <li><a href="{% url 'farmacias' %}">Farmacias</a></li>
            <li><a href="{% url 'crear_pedido' %}">Pedidos</a></li>
        </ul>
    </nav>

    <!-- Contenido dinámico -->
    <main>
        <!-- Página de Inicio -->
        {% if page == "index" %}
        <h1>Bienvenido al Sistema de Gestión de Farmacias</h1>
        <p>Utiliza el menú de navegación para explorar las funcionalidades.</p>

        <!-- Página de Lista de Farmacias -->
        {% elif page == "farmacias" %}
        <h1>Lista de Farmacias</h1>
        <ul>
            {% for farmacia in farmacias %}
            <li>
                <a href="{% url 'sucursales' farmacia.id %}">{{ farmacia.nombre }}</a>
            </li>
            {% endfor %}
        </ul>

        <!-- Página de Lista de Sucursales -->
        {% elif page == "sucursales" %}
        <h1>Sucursales de {{ farmacia.nombre }}</h1>
        <ul>
            {% for sucursal in sucursales %}
            <li>
                <a href="{% url 'inventario' sucursal.id %}">{{ sucursal.nombre }}</a>
            </li>
            {% endfor %}
        </ul>

        <!-- Página de Inventario -->
        {% elif page == "inventario" %}
        <h1>Inventario de {{ sucursal.nombre }}</h1>
        <table>
            <thead>
                <tr>
                    <th>Medicamento</th>
                    <th>Cantidad Disponible</th>
                </tr>
            </thead>
            <tbody>
                {% for item in inventarios %}
                <tr>
                    <td>{{ item.medicamento.nombre }}</td>
                    <td>{{ item.cantidad }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- Página de Pedidos -->
        {% elif page == "pedidos" %}
        <h1>Pedidos del Cliente {{ cliente.nombre }}</h1>
        <ul>
            {% for pedido in pedidos %}
            <li>
                <strong>Pedido {{ pedido.id }}</strong> - Fecha: {{ pedido.fecha }} - Estado: {{ pedido.estado }}
                <ul>
                    {% for detalle in pedido.detallepedido_set.all %}
                    <li>{{ detalle.medicamento.nombre }}: {{ detalle.cantidad }} unidades</li>
                    {% endfor %}
                </ul>
            </li>
            {% endfor %}
        </ul>

        <!-- Página de Crear Pedido -->
        {% elif page == "crear_pedido" %}
        <h1>Crear Nuevo Pedido</h1>
        <form action="{% url 'crear_pedido' %}" method="post">
            {% csrf_token %}
            <label for="cliente">Cliente:</label>
            <select id="cliente" name="cliente">
                {% for cliente in clientes %}
                <option value="{{ cliente.id }}">{{ cliente.nombre }}</option>
                {% endfor %}
            </select>
            <label for="inventario">Inventario Origen:</label>
            <select id="inventario" name="inventario">
                {% for inventario in inventarios %}
                <option value="{{ inventario.id }}">{{ inventario.farmacia.nombre }} - {{ inventario.medicamento.nombre }}</option>
                {% endfor %}
            </select>
            <label for="cantidad">Cantidad:</label>
            <input type="number" id="cantidad" name="cantidad" min="1" required>
            <button type="submit">Crear Pedido</button>
        </form>

        {% else %}
        <h1>Página no encontrada</h1>
        <p>Lo sentimos, la página que buscas no está disponible.</p>
        {% endif %}
    </main>

    <!-- Footer -->
    <footer>
        <p>© 2025 Sistema de Farmacias. Todos los derechos reservados.</p>
    </footer>
</body>
</html>
